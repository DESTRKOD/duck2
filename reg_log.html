<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
<style>
/* ===== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ===== */
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: linear-gradient(180deg, #0b3c91 0%, #1565c0 55%, #42a5f5 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

/* ===== –ö–û–ù–¢–ï–ô–ù–ï–†–´ ===== */
.container {
  width: 100%;
  max-width: 400px;
  padding: 20px;
  box-sizing: border-box;
  animation: slideIn 0.4s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.auth-box {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 22px;
  padding: 32px 28px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  text-align: center;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* ===== –õ–û–ì–û –ò –ó–ê–ì–û–õ–û–í–ö–ò ===== */
.logo-container {
  margin-bottom: 24px;
}

.lottie-logo {
  width: 80px;
  height: 80px;
  margin: 0 auto 12px;
}

h1 {
  color: #0b3c91;
  margin: 0 0 8px 0;
  font-size: 28px;
  font-weight: 800;
  letter-spacing: -0.5px;
}

.subtitle {
  color: #666;
  margin-bottom: 32px;
  font-size: 16px;
  line-height: 1.4;
  font-weight: 500;
}

/* ===== –ö–ù–û–ü–ö–ò –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ===== */
.auth-buttons {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 28px;
}

.auth-btn {
  padding: 18px 24px;
  border-radius: 14px;
  border: none;
  font-size: 18px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  position: relative;
  overflow: hidden;
}

.auth-btn::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 5px;
  height: 5px;
  background: rgba(255, 255, 255, 0.5);
  opacity: 0;
  border-radius: 100%;
  transform: scale(1, 1) translate(-50%);
  transform-origin: 50% 50%;
}

.auth-btn:focus:not(:active)::after {
  animation: ripple 1s ease-out;
}

@keyframes ripple {
  0% {
    transform: scale(0, 0);
    opacity: 0.5;
  }
  20% {
    transform: scale(25, 25);
    opacity: 0.3;
  }
  100% {
    opacity: 0;
    transform: scale(40, 40);
  }
}

.auth-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
}

.auth-btn:active {
  transform: translateY(0);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

/* –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ */
.btn-register {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
}

.btn-login {
  background: #000;
  color: white;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}

.btn-back {
  background: rgba(255, 255, 255, 0.1);
  color: #333;
  border: 2px solid rgba(0, 0, 0, 0.1);
  margin-top: 8px;
}

.auth-btn span:first-child {
  font-size: 20px;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}

/* ===== –ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–ï –ë–õ–û–ö–ò ===== */
.telegram-note {
  background: linear-gradient(135deg, #0088cc 0%, #006699 100%);
  color: white;
  padding: 16px;
  border-radius: 14px;
  margin: 24px 0;
  font-size: 15px;
  font-weight: 600;
  box-shadow: 0 8px 16px rgba(0, 136, 204, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  animation: pulseGlow 2s infinite;
}

@keyframes pulseGlow {
  0%, 100% {
    box-shadow: 0 8px 16px rgba(0, 136, 204, 0.3);
  }
  50% {
    box-shadow: 0 8px 24px rgba(0, 136, 204, 0.5);
  }
}

.telegram-note::before {
  content: 'üì±';
  font-size: 20px;
}

.info-box {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 16px;
  font-size: 14px;
  color: #666;
  text-align: left;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.info-box h3 {
  margin: 0 0 12px 0;
  color: #333;
  font-size: 16px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 8px;
}

.info-box h3::before {
  content: '‚ÑπÔ∏è';
}

.info-box ul {
  margin: 0;
  padding-left: 20px;
}

.info-box li {
  margin-bottom: 10px;
  line-height: 1.5;
  position: relative;
}

.info-box li::marker {
  color: #0b3c91;
  font-weight: bold;
}

/* ===== –°–¢–ê–¢–£–°–ù–´–ï –°–û–û–ë–©–ï–ù–ò–Ø ===== */
.loading {
  display: none;
  color: #0b3c91;
  font-weight: 700;
  margin: 24px 0;
  font-size: 16px;
  padding: 16px;
  background: rgba(11, 60, 145, 0.1);
  border-radius: 12px;
  border-left: 4px solid #0b3c91;
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

.success {
  display: none;
  color: #28a745;
  font-weight: 700;
  margin: 24px 0;
  font-size: 16px;
  padding: 16px;
  background: rgba(40, 167, 69, 0.1);
  border-radius: 12px;
  border-left: 4px solid #28a745;
}

.error {
  display: none;
  color: #dc3545;
  font-weight: 700;
  margin: 24px 0;
  background: rgba(220, 53, 69, 0.1);
  padding: 16px;
  border-radius: 12px;
  border-left: 4px solid #dc3545;
  font-size: 14px;
  animation: shake 0.5s ease-in-out;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

/* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ===== */
@media (max-width: 480px) {
  .container {
    padding: 16px;
  }
  
  .auth-box {
    padding: 24px 20px;
    border-radius: 20px;
  }
  
  .lottie-logo {
    width: 70px;
    height: 70px;
  }
  
  h1 {
    font-size: 24px;
  }
  
  .subtitle {
    font-size: 15px;
    margin-bottom: 28px;
  }
  
  .auth-btn {
    padding: 16px 20px;
    font-size: 16px;
    gap: 10px;
  }
  
  .telegram-note {
    padding: 14px;
    font-size: 14px;
    margin: 20px 0;
  }
  
  .info-box {
    padding: 16px;
    font-size: 13px;
  }
  
  .auth-btn span:first-child {
    font-size: 18px;
  }
}

@media (max-width: 360px) {
  .container {
    padding: 12px;
  }
  
  .auth-box {
    padding: 20px 16px;
  }
  
  .auth-btn {
    padding: 14px 16px;
    font-size: 15px;
  }
  
  .lottie-logo {
    width: 60px;
    height: 60px;
  }
}

/* ===== –≠–ö–†–ê–ù –£–°–ü–ï–®–ù–û–ô –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ===== */
.success-screen {
  display: none;
  text-align: center;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.success-icon {
  font-size: 60px;
  margin-bottom: 20px;
  animation: bounce 1s ease infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-10px);
  }
}

.success-title {
  color: #0b3c91;
  font-size: 26px;
  font-weight: 800;
  margin-bottom: 12px;
}

.success-message {
  color: #666;
  font-size: 16px;
  margin-bottom: 32px;
  line-height: 1.5;
}

/* ===== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ ===== */
.auth-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none !important;
  box-shadow: none !important;
}

.auth-btn.loading-state {
  position: relative;
  color: transparent;
}

.auth-btn.loading-state::before {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-top-color: white;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* –ü–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
@media (hover: hover) {
  * {
    scroll-behavior: smooth;
  }
}
</style>
</head>

<body>
<div class="container">
  <div class="auth-box">
    <!-- –õ–æ–≥–æ—Ç–∏–ø —Å Lottie –∞–Ω–∏–º–∞—Ü–∏–µ–π -->
    <div class="logo-container">
      <div id="lottie-lock" class="lottie-logo"></div>
      <h1>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h1>
      <div class="subtitle">–í–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∞–≥–∞–∑–∏–Ω—É</div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
    <div class="auth-buttons">
      <button class="auth-btn btn-register" id="registerBtn">
        <span>üìù</span>
        <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>
      </button>
      
      <button class="auth-btn btn-login" id="loginBtn">
        <span>üîë</span>
        <span>–í–æ–π—Ç–∏</span>
      </button>
      
      <button class="auth-btn btn-back" id="backBtn">
        <span>‚Üê</span>
        <span>–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω</span>
      </button>
    </div>
    
    <!-- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="telegram-note">
      –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è Telegram
    </div>
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫ -->
    <div class="info-box">
      <h3>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h3>
      <ul>
        <li>–ù–∞–∂–∏–º–∞–µ—Ç–µ –∫–Ω–æ–ø–∫—É "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è" –∏–ª–∏ "–í–æ–π—Ç–∏"</li>
        <li>–û—Ç–∫—Ä–æ–µ—Ç—Å—è Telegram —Å –±–æ—Ç–æ–º –º–∞–≥–∞–∑–∏–Ω–∞</li>
        <li>–ù–∞–∂–∏–º–∞–µ—Ç–µ "Start" –≤ –±–æ—Ç–µ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</li>
        <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–µ—Ç–µ—Å—å –≤ –º–∞–≥–∞–∑–∏–Ω</li>
      </ul>
    </div>
    
    <!-- –°—Ç–∞—Ç—É—Å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è -->
    <div class="loading" id="loading">
      ‚è≥ –û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram...
    </div>
    
    <div class="success" id="success">
      ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    </div>
    
    <div class="error" id="error"></div>
    
    <!-- –≠–∫—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="success-screen" id="successScreen">
      <div class="success-icon">‚úÖ</div>
      <div class="success-title">–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è!</div>
      <div class="success-message">–í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –º–∞–≥–∞–∑–∏–Ω...</div>
    </div>
  </div>
</div>

<script>
const API_URL = 'https://duck-shop-sever.onrender.com';
const SITE_URL = 'https://DESTRKOD.github.io/duck2';

// –≠–ª–µ–º–µ–Ω—Ç—ã
const registerBtn = document.getElementById('registerBtn');
const loginBtn = document.getElementById('loginBtn');
const backBtn = document.getElementById('backBtn');
const loading = document.getElementById('loading');
const success = document.getElementById('success');
const error = document.getElementById('error');
const successScreen = document.getElementById('successScreen');

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Lottie –∞–Ω–∏–º–∞—Ü–∏–∏
function initLottieAnimations() {
  try {
    lottie.loadAnimation({
      container: document.getElementById('lottie-lock'),
      renderer: 'svg',
      loop: true,
      autoplay: true,
      path: 'https://assets1.lottiefiles.com/packages/lf20_ktwnwv3m.json' // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–º–∫–∞
    });
  } catch (e) {
    console.log('Lottie –∞–Ω–∏–º–∞—Ü–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ç–∏—á–Ω—É—é –∏–∫–æ–Ω–∫—É');
    document.getElementById('lottie-lock').innerHTML = 'üîê';
  }
}

// –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç—É—Å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
function showStatus(type, message = '') {
  loading.style.display = 'none';
  success.style.display = 'none';
  error.style.display = 'none';
  
  switch(type) {
    case 'loading':
      loading.style.display = 'block';
      break;
    case 'success':
      success.style.display = 'block';
      break;
    case 'error':
      error.textContent = message;
      error.style.display = 'block';
      break;
  }
}

// –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏
function animateButton(button) {
  button.classList.add('pressed');
  setTimeout(() => button.classList.remove('pressed'), 200);
}

// –ù–∞–∑–∞–¥ –≤ –º–∞–≥–∞–∑–∏–Ω
backBtn.addEventListener('click', () => {
  animateButton(backBtn);
  setTimeout(() => {
    window.location.href = `${SITE_URL}/beta-duck.html`;
  }, 200);
});

// –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
async function handleAuth(endpoint, button) {
  // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
  animateButton(button);
  button.disabled = true;
  button.classList.add('loading-state');
  
  showStatus('loading');
  
  try {
    const response = await fetch(`${API_URL}/api/auth/${endpoint}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' }
    });
    
    const data = await response.json();
    
    if (data.success) {
      showStatus('success');
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
      button.disabled = false;
      button.classList.remove('loading-state');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —É—Å–ø–µ—Ö–∞
      document.querySelector('.auth-buttons').style.display = 'none';
      document.querySelector('.telegram-note').style.display = 'none';
      document.querySelector('.info-box').style.display = 'none';
      successScreen.style.display = 'block';
      
      // –û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
      setTimeout(() => {
        window.open(data.telegramLink, '_blank');
      }, 1000);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
      const checkInterval = setInterval(async () => {
        const checkResponse = await fetch(`${API_URL}/api/auth/check/${data.token}`);
        const checkData = await checkResponse.json();
        
        if (checkData.success && checkData.authenticated) {
          clearInterval(checkInterval);
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
          document.querySelector('.success-icon').textContent = 'üéâ';
          document.querySelector('.success-title').textContent = '–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!';
          document.querySelector('.success-message').textContent = '–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ –º–∞–≥–∞–∑–∏–Ω...';
          
          // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
          setTimeout(() => {
            window.location.href = `${SITE_URL}/beta-duck.html?auth=${data.token}`;
          }, 2000);
          
        } else if (checkData.success && checkData.expired) {
          clearInterval(checkInterval);
          showStatus('error', '‚ùå –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
          
          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
          document.querySelector('.auth-buttons').style.display = 'flex';
          document.querySelector('.telegram-note').style.display = 'flex';
          document.querySelector('.info-box').style.display = 'block';
          successScreen.style.display = 'none';
          button.disabled = false;
          button.classList.remove('loading-state');
        }
      }, 2000);
      
      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è 5 –º–∏–Ω—É—Ç–∞–º–∏
      setTimeout(() => {
        clearInterval(checkInterval);
      }, 5 * 60 * 1000);
      
    } else {
      button.disabled = false;
      button.classList.remove('loading-state');
      showStatus('error', `‚ùå ${data.error || '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è'}`);
    }
  } catch (err) {
    button.disabled = false;
    button.classList.remove('loading-state');
    showStatus('error', '‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
    console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', err);
  }
}

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
registerBtn.addEventListener('click', () => {
  handleAuth('start-register', registerBtn);
});

// –í—Ö–æ–¥
loginBtn.addEventListener('click', () => {
  handleAuth('start-login', loginBtn);
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', () => {
  initLottieAnimations();
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ ripple —ç—Ñ—Ñ–µ–∫—Ç–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫
  const buttons = document.querySelectorAll('.auth-btn');
  buttons.forEach(button => {
    button.addEventListener('click', function(e) {
      const x = e.clientX - e.target.getBoundingClientRect().left;
      const y = e.clientY - e.target.getBoundingClientRect().top;
      
      const ripple = document.createElement('span');
      ripple.style.left = x + 'px';
      ripple.style.top = y + 'px';
      ripple.classList.add('ripple');
      
      this.appendChild(ripple);
      
      setTimeout(() => {
        ripple.remove();
      }, 600);
    });
  });
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
  const urlParams = new URLSearchParams(window.location.search);
  const authToken = urlParams.get('auth');
  const autoAuth = urlParams.get('auto');
  
  if (authToken) {
    // –ï—Å–ª–∏ –ø–µ—Ä–µ—à–ª–∏ —Å —Ç–æ–∫–µ–Ω–æ–º, —Å—Ä–∞–∑—É –ø—Ä–æ–≤–µ—Ä—è–µ–º
    verifyAuthToken(authToken);
  } else if (autoAuth === 'true') {
    // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
    setTimeout(() => {
      registerBtn.click();
    }, 1000);
  }
});

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞
async function verifyAuthToken(token) {
  try {
    const response = await fetch(`${API_URL}/api/auth/check/${token}`);
    const data = await response.json();
    
    if (data.success && data.authenticated) {
      // –£–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
      const newUrl = window.location.pathname;
      window.history.replaceState({}, '', newUrl);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω —É—Å–ø–µ—Ö–∞
      document.querySelector('.auth-box').style.display = 'none';
      successScreen.style.display = 'block';
      document.querySelector('.success-icon').textContent = '‚úÖ';
      document.querySelector('.success-title').textContent = '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!';
      document.querySelector('.success-message').textContent = `–ü—Ä–∏–≤–µ—Ç, ${data.user.username}! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ –º–∞–≥–∞–∑–∏–Ω...`;
      
      // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
      setTimeout(() => {
        window.location.href = `${SITE_URL}/beta-duck.html`;
      }, 2000);
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞:', error);
  }
}

// –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è ripple —ç—Ñ—Ñ–µ–∫—Ç–∞
const style = document.createElement('style');
style.textContent = `
  .ripple {
    position: absolute;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.7);
    transform: scale(0);
    animation: ripple-animation 0.6s linear;
    pointer-events: none;
  }
  
  @keyframes ripple-animation {
    to {
      transform: scale(4);
      opacity: 0;
    }
  }
`;
document.head.appendChild(style);
</script>
</body>
</html>
